# Rescue-Net.eu

## Monorepo Structure

- apps/web    — Next.js 15 + Tailwind (TypeScript, i18n for 24 EU languages)
- apps/api    — NestJS 11 + Prisma 2 (TypeScript, authentication, CRUD, alert flow, membership management)
- apps/mobile — React Native (TypeScript, i18n, same functionality as web)
- packages/ui — shared React components (empty placeholder)
- packages/types — shared TypeScript types (empty placeholder)

## Existing Code Replaced
- Static HTML+JS frontend was fully replaced by Next.js (web) and React Native (mobile),  
  using i18n (next-i18next/react-i18next).  
- Python backend (FastAPI) was fully replaced by NestJS+Prisma (including routing, CRUD, authentication,  
  mission flow, alert flow, and membership management).

## Setup Instructions
1. Clone the repo and install dependencies:
   ```
   npm install
   ```
2. Copy `.env.example` to `.env` and fill in:  
   - `DATABASE_URL`  
   - `SMTP_HOST`  
   - `SMTP_PORT`  
   - `SMTP_USER`  
   - `SMTP_PASS`  
   - `INVITE_BASE_URL`  
3. Run Prisma migrations:
   ```
   cd apps/api
   npx prisma migrate dev --name init
   ```
4. Optionally integrate translations with Transifex:  
   - `tx push -s` to upload `en/common.json`.  
   - After translations are complete, `tx pull -a --mode=reviewed` to retrieve translated files.  
5. Start backend, web, and mobile:
   ```
   # Terminal 1 (backend):
   cd apps/api
   npm run start:dev

   # Terminal 2 (web):
   cd apps/web
   npm run dev

   # Terminal 3 (mobile iOS - macOS):
   cd apps/mobile
   npx react-native run-ios

   # Terminal 4 (mobile Android):
   cd apps/mobile
   npx react-native run-android
   ```
6. Test the flows:
   - **Volunteer**:  
     • `http://localhost:3000/signup/<token>` (fill out form, texts appear in chosen language).  
     • `http://localhost:3000/signup/direct` (direct signup).  
     • `http://localhost:3000/login` (login, JWT storage).  
     • `http://localhost:3000/dashboard` (view missions and local alerts, subscribe).  
     • **Mobile**: open the app, use SignupToken, SignupDirect, Login, VolunteerDashboard screens, verify texts appear in device language or manually changed language.  
   - **Operator/Admin**:  
     • `http://localhost:3000/admin/alerts` (create alert, view/approve, filter).  
     • On mobile, use the AdminAlertsScreen to create/approve alerts.  
   - **Memberships**:  
     • Verify membership management endpoints (GET /memberships, POST /memberships, PATCH /memberships/:id, DELETE /memberships/:id).  
   - **PLATFORM_ADMIN**: access global dashboard to approve PENDING_APPROVAL alerts (PATCH `/api/alerts/:id/status`).  

Note:
 - All UI text (e.g., “Create Alert” / “Creează Alertă”, “Subscribe to Alert” / “Abonează-te la Alertă”, etc.) is managed via JSON files in `public/locales/{lang}/common.json` (web) and `src/locales/{lang}/common.json` (mobile).  
 - The previous code, which did not implement membership endpoints or password-based authentication and lacked alert flow, has been fully replaced.  
- Ensure each file generated by Codex strictly follows the structure and content specified, including i18n and Transifex integration.

## Docker Deployment

You can build a Docker image that runs both the API and the web app:

```bash
# build the image
docker build -t rescue-net .

# run the container (expects DATABASE_URL and other env vars)
docker run -p 3000:3000 -p 3001:3001 --env-file .env rescue-net
```

The image compiles the monorepo and starts the NestJS API on port **3001**
and the Next.js web server on port **3000**.
